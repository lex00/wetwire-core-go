name: aws_gitlab_s3_deploy
description: S3 bucket with GitLab CI/CD pipeline for deployment

# Model to use: haiku (fast), sonnet (balanced), opus (best quality)
model: haiku

prompts:
  default: prompt.md
  variants:
    beginner: prompts/beginner.md
    intermediate: prompts/intermediate.md
    expert: prompts/expert.md
    terse: prompts/terse.md
    verbose: prompts/verbose.md

domains:
  - name: aws
    cli: wetwire-aws
    mcp_tools:
      lint: wetwire_lint
      build: wetwire_build
      validate: wetwire_validate
    outputs:
      - cfn-templates/s3-bucket.yaml

  - name: gitlab
    cli: wetwire-gitlab
    mcp_tools:
      lint: wetwire_lint
      build: wetwire_build
    depends_on:
      - aws
    outputs:
      - .gitlab-ci.yml

cross_domain:
  - from: aws
    to: gitlab
    type: artifact_reference
    validation:
      required_refs:
        - "${aws.s3.outputs.bucket_name}"

validation:
  aws:
    stacks:
      min: 1
      max: 1
    resources:
      min: 1
  gitlab:
    pipelines:
      min: 1
